Title: Exploring Genetic and Demographic Predictors of Left Ventricular Ejection Fraction

Data from patients at Pineapple hospital who had their LVEF and genotype recorded

```{r}
install.packages("dplyr")
library(dplyr)
install.packages("ggplot2")
library(ggplot2)
install.packages("tableone")
library(tableone)
install.packages("gtsummary")
library(gtsummary)
install.packages("gt")
library(gt)
install.packages("tidyverse")
library(tidyverse)
install.packages("knitr")
library(knitr)
install.packages("xtable")
library(xtable)

patient_data <- read.csv("/Users/minenhle/Library/CloudStorage/OneDrive-UniversityofWitwatersrand/mini_projects/dcm_rproject/data.csv")

```


Cleaning the data steps

Change gender,genotype to a categorical variables
```{r}
patient_data$Gender <-factor(patient_data$Gender)
patient_data$SNP_TTN <-factor(patient_data$SNP_TTN)
```

Check for missing data
```{r}
colSums(is.na(patient_data))
rowSums(is.na(patient_data))

```

Check for duplicates
```{r}
duplicated(patient_data[,c("ID")])
patient_data<-patient_data[!duplicated(patient_data),]

```

Basic summaries
```{r}
str(patient_data)
summary(patient_data)
```

Create baseline characteristics table

```{r}
vars<- c("SNP_TTN", "Gender", "LVEF", "Age")
factorVars <- c("SNP_TTN", "Gender")
table1 <- CreateTableOne(vars = vars, data = patient_data, factorVars = factorVars)
table_1 <- print(table1, showAllLevels = TRUE)
gt_table <- table_1 %>%
  gt() %>%
  tab_header(
    title = md("**Table 1. Baseline Characteristics**")
  ) %>%
  tab_options(
    table.font.size = "small",
    heading.align = "left",
    data_row.padding = px(4)
  )

gt_table
```

Descriptive and distributional insights

Distribution of age

```{r}

gender_counts <- patient_data %>%
  count(Gender)

gender <- ggplot(gender_counts, aes(x = "", y = n, fill = Gender)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
  labs(title = "Gender Distribution")

gender
```

1. Distribution of age by gender

```{r}
agebygender<-ggplot(patient_data, aes(x = Age, fill = Gender)) +
  geom_histogram(binwidth =10, position = "stack", color = "white", alpha = 0.8) +
  labs(title = "Age Distribution by Gender",
       x = "Age (years)",
       y = "Count") +
  theme_minimal()
agebygender
```

2. Distribution of lvef by age 
```{r}
lvefbyagegender<-ggplot(patient_data, aes(x = Age, y = LVEF)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "loess", se = FALSE, color = "blue") +
  facet_wrap(~Gender) +
  labs(title = "LVEF vs Age by Gender")

lvefbyagegender
```

3. LVEF by Genotype

```{r}
lvefgenotype<-ggplot(patient_data, aes(x = SNP_TTN, y = LVEF, fill = SNP_TTN)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "LVEF Distribution by Genotype",
       x = "Genotype",
       y = "LVEF (%)") +
  theme_minimal()

lvefgenotype
```


4. See if there is mean difference in LVEF between male and female

```{r}
t.test(LVEF ~ Gender, data = patient_data)

```

p-value = 0.007339

5. How Genotype varies by age and gender

```{r}
chisq.test(table(patient_data$SNP_TTN, patient_data$Gender)) 
chisq.test(table(patient_data$SNP_TTN, patient_data$Age))
```




